### YamlMime:FAQ
metadata:
  title: Azure SQL Database Hyperscale 名前付きレプリカに関する FAQ
  description: Hyperscale サービス レベルの名前付きレプリカでの SQL Database のデータベースに関してお客様からよくある質問への回答
  services: sql-database
  ms.service: sql-database
  ms.subservice: 
  ms.custom: 
  ms.devlang: 
  ms.topic: conceptual
  author: yorek
  ms.author: damauri
  ms.reviewer: 
  ms.date: 06/09/2021
  ms.openlocfilehash: 53dd0035a9ee973b68b7a1f795e500775e226e3f
  ms.sourcegitcommit: 285d5c48a03fcda7c27828236edb079f39aaaebf
  ms.translationtype: HT
  ms.contentlocale: ja-JP
  ms.lasthandoff: 07/02/2021
  ms.locfileid: "113233444"
title: Azure SQL Database Hyperscale 名前付きレプリカに関する FAQ
summary: "[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]\n\nこの記事では、Azure SQL Database ハイパースケール サービス レベル (以降、この FAQ ではハイパースケールと呼びます) のデータベースをご検討中のお客様向けに、よく寄せられる質問の回答を紹介します。 この記事では、ハイパースケールでサポートするシナリオと、ハイパースケールと互換性がある機能について説明します。\n\n- この FAQ は、Hyperscale サービス レベルの名前付きレプリカの概要を理解し、具体的な質問や懸案事項の回答を求める読者を対象としています。\n- Hyperscale 名前付きレプリカの詳細については、[Hyperscale レプリカの名前付きレプリカ](service-tier-hyperscale-replicas.md#named-replica-in-preview)に関するセクションを参照してください。 \n"
sections:
- name: 一般的な質問
  questions:
  - question: >
      名前付きレプリカをフェールオーバー ターゲットとして使用できますか?
    answer: >
      いいえ。名前付きレプリカをフェールオーバー ターゲットとして使用することはできません。 その目的には HA レプリカを使用します。
  - question: >
      どうすれば、名前付きレプリカ間に読み取り専用ワークロードを分散させることができますか?
    answer: >
      すべての名前付きレプリカは、異なるサービス レベル目標を持つ場合があり、したがって異なるユース ケースに使用される可能性があるため、プライマリに送信された読み取り専用トラフィックを関連する名前付きレプリカに転送する組み込みの方法はありません。 たとえば、8 個の名前付きレプリカがある場合、OLTP ワークロードは名前付きレプリカ 1 から 4 にのみ転送し、すべての Power BI 分析ワークロードでは名前付きレプリカ 5 と 6 を使用し、データ サイエンス ワークロードにはレプリカ 7 と 8 を使用することができます。 そのようなワークロードを分散する戦略は、使用するツールまたはプログラミング言語によって異なる場合があります。 REST バックエンドがスケールアウトできるようにワークロード ルーティング ソリューションを作成する例の 1 つについては、こちらの [OLTP スケールアウト サンプル](https://github.com/Azure-Samples/azure-sql-db-named-replica-oltp-scaleout)を参照してください。
  - question: >
      プライマリ レプリカのリージョンとは異なるリージョンに名前付きレプリカを作成できますか?
    answer: >
      いいえ。名前付きレプリカではプライマリ レプリカと同じページ サーバーが使用されるため、それらは同じリージョンに存在する必要があります。
  - question: >
      名前付きレプリカにより、プライマリ レプリカの可用性またはパフォーマンスが影響を受けることはありますか?
    answer: >
      名前付きレプリカによってプライマリ レプリカの可用性が影響を受けることはありません。 通常の状況では、名前付きレプリカがプライマリのパフォーマンスに影響を与える可能性はほとんどありませんが、負荷の高いワークロードが実行されている場合は発生する可能性があります。 HA レプリカと同様に、名前付きレプリカはトランザクション ログ サービスを介してプライマリと同期されます。 何らかの理由で名前付きレプリカがトランザクション ログを十分高速に使用できない場合、追い付くことができるよう、ログの生成を遅くする (スロットル) ようプライマリ レプリカに要求し始めます。 この動作は、プライマリの可用性には影響しませんが、パフォーマンスに影響します。 この状況を回避するには、遅延なくトランザクション ログを処理できるよう、名前付きレプリカに十分な空きリソース (主に CPU) があることを確認します。 たとえば、プライマリで多数のデータ変更が処理されている場合は、レプリカで CPU のボトルネックが発生して、プライマリの速度が低下しないように、名前付きレプリカのサービス レベル目標をプライマリ以上にすることをお勧めします。
  - question: >
      計画メンテナンスのためなどで、プライマリ レプリカが使用できない場合、名前付きレプリカはどうなりますか?
    answer: >
      名前付きレプリカは、通常どおり、読み取り専用アクセスに引き続き使用できます。
  - question: >
      SQL Server Management Studio (SSMS) や他のクライアント ツールを使用してセカンダリ計算レプリカに正常に接続したかどうかを確認するには、どうすればよいですか?
    answer: >
      次の T-SQL クエリを実行できます。


      ```sql

      SELECT @@SERVERNAME, DB_NAME(), DATABASEPROPERTYEX(DB_NAME(), 'Updateability');

      ```


      結果は、読み取り専用セカンダリ レプリカに接続されている場合は `READ_ONLY`、プライマリ レプリカに接続されている場合は `READ_WRITE` になります。 データベース コンテキストは、`master` データベースではなく、Hyperscale データベースの名前に設定する必要があります。
  - question: >
      セカンダリ計算レプリカにオブジェクトまたはインデックスを作成できますか?
    answer: >
      いいえ。 ハイパースケール データベースではストレージが共有されます。つまり、すべての計算レプリカは同じテーブル、インデックス、ビューを見ることができます。 読み取りに対して最適化したインデックスをセカンダリに追加したい場合は、プライマリに追加する必要があります。


      それでも、一時テーブルを作成して使用し、一時データを格納することはできます。
  - question: >
      プライマリ計算レプリカとセカンダリ計算レプリカの間の遅延はどれくらいですか?
    answer: >
      トランザクションがプライマリ上でコミットされてからセカンダリで読み取り可能になるまでのデータ待機時間は、現在のログ生成速度、トランザクション サイズ、レプリカへの負荷、およびその他の要因によって異なります。 小規模なトランザクションの一般的なデータ待機時間は数十ミリ秒ですが、データ待機時間に上限はありません。 特定のセカンダリ レプリカのデータは、トランザクションに対して常に一貫性があります。 ただし、特定の時点でのデータの待機時間は、セカンダリ レプリカによって異なる場合があります。 コミットされたデータの読み取りが直ちに必要なワークロードは、プライマリ レプリカで実行される必要があります。
  - question: >
      どうすれば、名前付きレプリカの可用性を向上させることができますか?
    answer: >
      既定では、名前付きレプリカには HA レプリカはありません。 ただし、それらは通常の (読み取り専用の) Azure SQL データベースのように動作するので、HA レプリカによって提供される[より高い SLA](https://azure.microsoft.com/support/legal/sla/azure-sql-database/) のベネフィットを受けることができます。 HA レプリカの数を設定するには、[AZ CLI](/cli/azure/sql/db/replica?view=azure-cli-latest#az_sql_db_replica_create) の `--ha-replicas` パラメーター、[PowerShell](/powershell/module/az.sql/set-azsqldatabase) の `--HighAvailabilityReplicaCount` パラメーター、または [REST API](/rest/api/sql/2021-02-01-preview/databases/create-or-update) の `highAvailabilityReplicaCount` プロパティを使用できます。

      HA レプリカの数は、名前付きレプリカの作成時に設定でき、名前付きレプリカの作成後にいつでも変更できます (AZ CLI、PowerShell、または REST API のみを使用)。 名前付きレプリカの HA レプリカの価格は、通常のデータベースの HA レプリカと同じです。
additionalContent: "\n## <a name=\"next-steps\"></a>次のステップ\n\nハイパースケール サービス レベルについて詳しくは、[ハイパースケール サービス レベル](service-tier-hyperscale.md)に関するページをご覧ください。\nHyperscale レプリカの詳細については、[Hyperscale レプリカ](service-tier-hyperscale-replicas.md)に関する記事を参照してください。"
