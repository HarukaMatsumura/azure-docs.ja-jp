---
title: Azure HPC Cache の集約された名前空間を構成する
description: Azure HPC Cache を使用してバックエンド ストレージのクライアント側パスを作成する方法
author: ekpgh
ms.service: hpc-cache
ms.topic: how-to
ms.date: 09/30/2020
ms.author: v-erkel
ms.openlocfilehash: e525fc0705dffcd4765e6a1f6c5235bdef260fcd
ms.sourcegitcommit: 9eda79ea41c60d58a4ceab63d424d6866b38b82d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/30/2020
ms.locfileid: "96339678"
---
# <a name="set-up-the-aggregated-namespace"></a>集約された名前空間を設定する

ストレージ ターゲットを作成したら、そのターゲットの名前空間パスも作成する必要があります。 クライアント コンピューターは、バックエンド ストレージに直接接続するのではなく、これらの仮想パスを使用してキャッシュを介してファイルにアクセスします。 このシステムにより、キャッシュ管理者は、クライアントの指示を書き換えなくてもバックエンド ストレージ システムを変更できます。

この機能の詳細については、「[集約された名前空間を計画する](hpc-cache-namespace.md)」を参照してください。

Azure portal の **[名前空間]** ページには、クライアントがキャッシュを介してデータにアクセスするために使用するパスが表示されます。 このページを使用すると、名前空間パスを作成、削除、または変更できます。 Azure CLI を使用して名前空間パスを構成することもできます。

既存のクライアント側パスはすべて、 **[名前空間]** ページに一覧表示されます。 ストレージ ターゲットにパスがない場合は、テーブルには表示されません。

矢印をクリックしてテーブルの列を並べ替えると、キャッシュの集約された名前空間をよりよく理解できます。

![テーブルに 2 つのパスが表示されたポータルの名前空間ページのスクリーンショット。 列見出し:名前空間パス、ストレージ ターゲット、エクスポート パス、およびエクスポート サブディレクトリ。 最初の列の項目はクリック可能なリンクです。 上部のボタン:名前空間パスの追加、更新、削除](media/namespace-page.png)

## <a name="add-or-edit-client-facing-namespace-paths"></a>クライアント側の名前空間パスを追加または編集する

クライアントがストレージ ターゲットにアクセスするには、少なくとも 1 つの名前空間パスを作成する必要があります (クライアント アクセスの詳細については、「[Azure HPC Cache をマウントする](hpc-cache-mount.md)」を参照してください)。

### <a name="blob-namespace-paths"></a>BLOB 名前空間パス

Azure Blob Storage ターゲットは、名前空間パスを 1 つだけ持つことができます。

次の手順に従って、Azure portal または Azure CLI でパスを設定または変更します。

### <a name="portal"></a>[ポータル](#tab/azure-portal)

Azure portal から **[名前空間]** 設定ページを読み込みます。 このページでは、名前空間パスを追加、変更、または削除することができます。

* **新しいパスの追加:** 上部にある **[+ 追加]** ボタンをクリックし、編集パネルに情報を入力します。

  * ドロップダウン リストからストレージ ターゲットを選択します (このスクリーンショットでは、既に名前空間パスが指定されているため、Blob Storage ターゲットを選択できません)。

    ![ストレージ ターゲット セレクターが表示された新しい名前空間編集フィールドのスクリーンショット](media/namespace-select-storage-target.png)

  * Azure Blob Storage ターゲットの場合、エクスポートおよびサブディレクトリのパスは自動的に ``/`` に設定されます。

* **既存のパスの変更:** 名前空間パスをクリックします。 編集パネルが開き、パスを変更できます。

  ![BLOB 名前空間パスをクリックした後の名前空間ページのスクリーンショット。右側のペインに編集フィールドが表示されます](media/edit-namespace-blob.png)

* **名前空間パスの削除:** パスの左側にあるチェックボックスをオンにして、 **[削除]** ボタンをクリックします。

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Azure HPC Cache 向けに Azure CLI を設定します](./az-cli-prerequisites.md)。

Azure CLI を使用する場合は、ストレージ ターゲットを作成するときに名前空間パスを追加する必要があります。 詳細については、「[新しい Azure Blob Storage ターゲットを追加する](hpc-cache-add-storage.md?tabs=azure-cli#add-a-new-azure-blob-storage-target)」を参照してください。

ターゲットの名前空間パスを更新するには、[az hpc-cache blob-storage-target update](/cli/azure/ext/hpc-cache/hpc-cache/blob-storage-target#ext-hpc-cache-az-hpc-cache-blob-storage-target-update) コマンドを使用します。 update コマンドの引数は create コマンドの引数に似ていますが、コンテナー名またはストレージ アカウントを渡さない点が異なります。

Azure CLI を使用して Blob Storage ターゲットから名前空間パスを削除することはできませんが、別の値でパスを上書きすることはできます。

---

### <a name="nfs-namespace-paths"></a>NFS 名前空間パス

各パスが同じストレージ システム上の別のエクスポートまたはサブディレクトリを表している限り、1 つの NFS ストレージ ターゲットに複数の仮想パスを使用できます。

NFS ストレージ ターゲットの名前空間を計画する場合は、各パスが一意である必要があり、別の名前空間パスのサブディレクトリにすることはできないことに注意してください。 たとえば、``/parent-a`` という名前空間パスがある場合、``/parent-a/user1`` や ``/parent-a/user2`` などの名前空間パスを作成することはできません。 これらのディレクトリ パスは、``/parent-a`` のサブディレクトリとして既に名前空間内でアクセス可能です。

NFS ストレージ システムのすべての名前空間パスは、1 つのストレージ ターゲット上に作成されます。 ほとんどのキャッシュ構成ではストレージ ターゲットあたり最大 10 個の名前空間パスがサポートされますが、大規模な構成では最大 20 個までサポートできます。

次の一覧に、構成ごとの名前空間パスの最大数を示します。

* 最大 2 GB/秒のスループット:

  * 3 TB のキャッシュ - 10 の名前空間パス
  * 6 TB のキャッシュ - 10 の名前空間パス
  * 23 TB のキャッシュ - 20 の名前空間パス

* 最大 4 GB/秒のスループット:

  * 6 TB のキャッシュ - 10 の名前空間パス
  * 12 TB のキャッシュ - 10 の名前空間パス
  * 24 TB のキャッシュ - 20 の名前空間パス

* 最大 8 GB/秒のスループット:

  * 12 TB のキャッシュ - 10 の名前空間パス
  * 24 TB のキャッシュ - 10 の名前空間パス
  * 48 TB のキャッシュ - 20 の名前空間パス

NFS 名前空間パスごとに、クライアント側パス、ストレージ システム エクスポート、および必要に応じてエクスポート サブディレクトリを指定します。

### <a name="portal"></a>[ポータル](#tab/azure-portal)

Azure portal から **[名前空間]** 設定ページを読み込みます。 このページでは、名前空間パスを追加、編集、または削除することができます。

* **新しいパスを追加するには:** 上部にある **[+ 追加]** ボタンをクリックし、編集パネルに情報を入力します。
* **既存のパスを変更するには:** 名前空間パスをクリックします。 編集パネルが開き、パスを変更できます。
* **名前空間パスを削除するには:** パスの左側にあるチェックボックスをオンにして、 **[削除]** ボタンをクリックします。

各名前空間パスに対して、次の値を入力します。

* **[名前空間パス]** - クライアント側のファイル パス。

* **[ストレージ ターゲット]** - 新しい名前空間パスを作成する場合は、ドロップダウン メニューからストレージ ターゲットを選択します。

* **[エクスポート パス]** - NFS エクスポートのパスを入力します。 エクスポート名が正しく入力されていることを確認してください。このフィールドの構文は検証されますが、変更を送信するまでエクスポートの確認は行われません。

* **[エクスポート サブディレクトリ]** - このパスにエクスポートの特定のサブディレクトリをマウントしたい場合は、ここに入力します。 それ以外の場合、このフィールドは空白のままにしてください。

![右側に更新ページが表示されているポータルの名前空間ページのスクリーンショット](media/update-namespace-nfs.png)

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Azure HPC Cache 向けに Azure CLI を設定します](./az-cli-prerequisites.md)。

Azure CLI を使用する場合は、ストレージ ターゲットを作成するときに少なくとも 1 つの名前空間パスを追加する必要があります。 詳細については、「[新しい NFS ストレージ ターゲットを追加する](hpc-cache-add-storage.md?tabs=azure-cli#add-a-new-nfs-storage-target)」を参照してください。

ターゲットの名前空間パスを更新するか、別のパスを追加するには、[az hpc-cache nfs-storage-target update](/cli/azure/ext/hpc-cache/hpc-cache/nfs-storage-target#ext-hpc-cache-az-hpc-cache-nfs-storage-target-update) コマンドを使用します。 ``--junction`` オプションを使用して、必要なすべての名前空間パスを指定します。

update コマンドで使用するオプションは "create" コマンドに似ていますが、ストレージ システムの情報 (IP アドレスまたはホスト名) を渡さず、使用モデルがオプションである点が異なります。 ``--junction`` オプションの構文の詳細については、「[新しい NFS ストレージ ターゲットを追加する](hpc-cache-add-storage.md?tabs=azure-cli#add-a-new-nfs-storage-target)」を参照してください。

---

## <a name="next-steps"></a>次のステップ

ストレージ ターゲットの集約された名前空間を作成したら、クライアントをキャッシュにマウントできます。 詳細については、次の記事を参照してください。

* [Azure HPC キャッシュをマウントする](hpc-cache-mount.md)
* [Azure Blob Storage にデータを移動する](hpc-cache-ingest.md)
