---
title: 新しい Azure IoT Hub ユーザー向けの基本的な概念 | Microsoft Docs
description: この記事では、Azure IoT Hub の新しいユーザー向けの基本的な概念について説明します
author: robinsh
ms.author: robinsh
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 07/07/2021
ms.openlocfilehash: 28c91ee86a2657e5483d6d0287be8d42bd1fac23
ms.sourcegitcommit: 0046757af1da267fc2f0e88617c633524883795f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/13/2021
ms.locfileid: "121725304"
---
# <a name="iot-concepts"></a>IoT の概念

IoT Hub は、クラウドでホストされるマネージド サービスです。IoT アプリケーションとそこに接続されたデバイスとの間における双方向の通信において、中央のメッセージ ハブとしての役割を担います。 何百万ものデバイスとそのバックエンド ソリューションとを、高い信頼性で安全に接続することができます。 IoT ハブには、ほぼすべてのデバイスを接続することができます。 

クラウドからデバイスを制御するための要求と応答の手法、device-to-cloud テレメトリ、デバイスからのファイルのアップロードなど、サポートされるメッセージング パターンはいくつかあります。 IoT Hub は、監視もサポートしており、デバイスの作成、デバイスの接続、デバイスの障害を効率的に追跡することができます。

IoT Hub の機能を使うと、製造で使われる産業機器の管理、医療での価値の高い資産の追跡、オフィス ビルの使用状況の監視など、スケーラブルで機能を完備した IoT ソリューションを構築できます。

IoT デバイスには、ブラウザーやモバイル アプリなどの他のクライアントとは異なる特性があります。 [デバイス SDK](iot-hub-devguide-sdks.md) は、デバイスを安全に、かつ高い信頼性でバックエンド サービスに接続するという課題の解決を支援します。 

具体的には、IoT デバイスの特性は次のとおりです。

- 多くの場合、人間が操作することのない組み込みシステムです (電話とは異なります)。
- 物理アクセスに大きなコストがかかる離れた場所にデプロイされている場合があります。
- ソリューション バック エンド経由でしか到達できない場合があります。
- 電源や処理リソースが限られている場合があります。
- ネットワーク接続が断続的に切れたり、遅かったり、高コストである場合があります。
- 専用、カスタム、または業界固有のアプリケーション プロトコルを使用することが必要になる場合があります。

## <a name="securely-connect-and-communicate"></a>安全に接続して通信する

デバイスごとの認証により、各デバイスは IoT Hub に安全に接続でき、各デバイスを安全に管理できます。 ユーザーは、デバイスのアクセスを完全に制御でき、デバイスごとのレベルで接続を制御できます。

### <a name="devices-have-a-secure-identity"></a>セキュリティ保護されたデバイス ID

すべての IoT ハブには、その IoT ハブへの接続が許可されたデバイスおよびモジュールに関する情報を保存する ID レジストリがあります。 デバイスまたはモジュールを IoT ハブに接続できるようにするには、そのデバイスまたはモジュールのエントリが IoT ハブの ID レジストリに存在する必要があります。 さらに、ID レジストリに保存されている資格情報に基づいて、デバイスまたはモジュールが IoT ハブで認証される必要があります。

デバイスと IoT Hub の間では、2 つの認証方法がサポートされています。 あるケースでは、SAS トークンベースの認証を使用できます。 別の方法として、X.509 証明書による認証もサポートしています。

SAS ベースのトークンの方法では、各呼び出しに対称キーを関連付けることによって、IoT Hub にデバイスで実行する各呼び出しの認証を提供します。 X.509 ベースの認証は、トランスポート層セキュリティ (TLS) 標準接続の確立の一部として物理層に IoT デバイスの認証を許可します。 安全性が低いパターンである X.509 認証を行わず、セキュリティ トークン ベースのメソッドを使用できます。 2 つの方法の選択は主に、いかに安全なデバイス認証が必要であるか、また (秘密キーを安全に格納して) デバイスにセキュリティで保護された記憶域の可用性によって決まります。

Azure IoT SDK を使用すると、自動的にトークンを生成できます。その際、特別な構成は必要ありません。 SDK を使用しない場合は、セキュリティ トークンを生成する必要があります。

[IoT Hub Device Provisioning Service](../iot-dps/index.yml) を使用して、一度に多数のデバイスを設定し、プロビジョニングできます。

### <a name="devices-can-securely-communicate-with-an-iot-hub"></a>デバイスが IoT Hub と安全に通信

認証方法の選択後、IoT デバイスと IoT Hub の間のインターネット接続は、トランスポート層セキュリティ (TLS) 標準を使用してセキュリティ保護されます。 Azure IoT では TLS 1.2、TLS 1.1、TLS 1.0 の順序でサポートされます。 TLS 1.0 のサポートは、旧バージョンとの互換性を保つために提供されます。 TLS 1.2 を使用するようにハブを構成する方法については、IoT Hub での TLS のサポートを参照してください。これにより、最も高いセキュリティが確保されます。

## <a name="communication-patterns-with-a-device"></a>デバイスとの通信パターン

通常、IoT デバイスは、クラウド内のバックエンド サービスに対し、センサーのテレメトリを送信します。 ただし、対応している通信の種類はそれだけではなく、たとえば、バックエンド サービスからデバイスにコマンドを送信することもできます。 さまざまな通信の種類の例を次に示します。 

*  冷凍トラックから IoT ハブに 5 分おきに温度を送信する
*  バックエンド サービスからデバイスにコマンドを送信して、問題の診断に使用されるテレメトリの送信頻度を変更する
*  化学プラント内の回分反応器を監視しているデバイスから、温度が特定の値を超えたときにアラートを送信する

### <a name="telemetry-is-data-emitted-by-a-device"></a>テレメトリはデバイスの出力データ 

たとえば、速度や温度などのセンサー データ、見逃されたイベントなどのエラー メッセージ、デバイスが正常な状態であることを示す情報メッセージといったテレメトリを、デバイスから受信します。 IoT デバイスはイベント (通知、受信確認、テレメトリ) をアプリケーションに送信して、分析情報を取得します。 アプリケーションでは、処理のために特定のイベントのサブセットや、さまざまなエンドポイントでの保存が必要になる場合があります。

### <a name="properties-are-state-values-or-data-that-applications-can-access"></a>プロパティはアプリケーションがアクセスできる状態の値またはデータ 

たとえば、デバイスの現在のファームウェア バージョンや、更新できる書き込み可能なプロパティ (温度など) はプロパティです。 プロパティは IoT Hub から読み取ったり設定したりできます。また、アクションが完了したときに、プロパティを使って通知を送信することができます。 デバイス上の特定のプロパティの例としては、気温が挙げられます。 これは、デバイス上で更新できる書き込み可能なプロパティにできるほか、デバイスにアタッチされている温度センサーから読み取ることもできます。 

IoT Hub 内でプロパティを有効にするには、[デバイス ツイン](iot-hub-devguide-device-twins.md)または[プラグ アンド プレイ](../iot-develop/overview-iot-plug-and-play.md)を使用します。

    
デバイス ツインとプラグ アンド プレイの違いの詳細については、[プラグ アンド プレイ](../iot-develop/concepts-digital-twin.md#device-twins-and-digital-twins)に関するページをご覧ください。

### <a name="commands-can-be-used-to-execute-methods-directly-on-connected-devices"></a>コマンドを使用して接続デバイス上でメソッドを直接実行可能 

コマンドの例としては、デバイスの再起動があります。 IoT Hub では、デバイス上でクラウドから直接メソッドを呼び出せるようにすることで、コマンドが実装されます。 [ダイレクト メソッド](iot-hub-devguide-direct-methods.md)は、デバイスとの要求/応答型通信を表し、すぐに要求の成功または失敗が確定する (ユーザーが指定したタイムアウト後) という点で HTTP 呼び出しに似ています。 この方法は、デバイスが応答できるかどうかに応じて即座に実行するアクションが異なるシナリオで便利です。

## <a name="view-and-act-on-data-collected-from-your-devices"></a>ご自身のデバイスから収集されたデータの表示および操作

IoT Hub を使用すると、ご自身のデバイス データの価値を、他の Azure サービスを使って引き出せるため、事後対応型の管理から、予測型の問題解決に移行することができます。 お使いの IoT Hub を他の Azure サービスと接続することで、機械学習、分析、AI を活用してリアルタイムのデータを操作し、処理を最適化して、より詳細な分析情報を取得できます。

### <a name="built-in-endpoint-collects-data-from-your-devices-by-default"></a>組み込みエンドポイントが既定でデバイスからデータを収集

組み込みエンドポイントが、お使いのデバイスから既定でデータを収集します。 データは、専用の IoT デバイス エンドポイントに対する要求 - 応答パターンを使用して収集され、最大 7 日間、デバイスでのアクション実行に使用できます。 デバイス エンドポイントによって受け入れられるデータを次に示します。

*    デバイスからクラウドへのメッセージを送信します。 デバイスは、このエンドポイントを使用して、デバイスからクラウドへのメッセージを送信します。

*    クラウドからデバイスへのメッセージを受信します。 デバイスは、このエンドポイントを使用して、そのデバイスが宛先となっている C2D メッセージを受信します。

*    ファイルのアップロードの開始。 デバイスでは、ファイルをアップロードするために、このエンドポイントを使用して、IoT Hub から Azure Storage の SAS URI を受け取ります。

*    デバイス ツインのプロパティを取得して更新します。 デバイスは、このエンドポイントを使用して、そのデバイス ツインのプロパティにアクセスします。 

*    ダイレクト メソッド要求の受信。 デバイスは、このエンドポイントを使用して、ダイレクト メソッドの要求をリッスンします。 

IoT Hub のエンドポイントの詳細については、[IoT Hub 開発者ガイドのエンドポイント](
iot-hub-devguide-endpoints.md#list-of-built-in-iot-hub-endpoints)に関するページをご覧ください

### <a name="use-message-routing-to-send-data-to-other-endpoints-for-processing"></a>メッセージ ルーティングを使用して、処理のために他のエンドポイントにデータを送信する

さらに処理するために、データを別のサービスにルーティングすることもできます。 IoT ソリューションがスケールアウトされると、デバイスの数、イベントの量、イベントの種類、各種サービスも変化します。 このパターンに対応するには、柔軟、スケーラブル、一貫性があり、信頼性の高い方法でイベントをルーティングする必要があります。 データをフィルター処理して、さまざまなサービスに送信することもできます。 メッセージ ルートが作成されると、フォールバック ルートが構成されていない限り、組み込みエンドポイントへのデータ フローが止まります。 メッセージ ルーティングの複数の使用方法を示すチュートリアルについては、[ルーティングのチュートリアル](tutorial-routing.md)を参照してください。

IoT Hub は Event Grid とも統合されているため、複数のサブスクライバーにデータをファン アウトできます。 Event Grid は、Azure のさまざまなサービスおよびアプリケーション全体でイベントの管理を簡単にするフル マネージド イベント サービスです。 パフォーマンスとスケールを実現するために、イベント ドリブン アプリケーションとサーバーレス アーキテクチャの構築を簡素化します。 Event Grid の詳細をご確認ください。 メッセージ ルーティングと Event Grid の使用の違いについては、[メッセージ ルーティングと Event Grid の比較](iot-hub-event-grid-routing-comparison.md)に関するページをご覧ください