---
title: Azure Key Vault セキュリティ
description: Azure Key Vault、キー、シークレットのアクセス許可を管理します。 キー コンテナーの認証と承認モデルおよびキー コンテナーをセキュリティで保護する方法について説明します。
services: key-vault
author: msmbaldwin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: general
ms.topic: conceptual
ms.date: 09/30/2020
ms.author: mbaldwin
ms.openlocfilehash: c3dd4e5138741a3c035507358830f3572cf92751
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/09/2020
ms.locfileid: "91739692"
---
# <a name="azure-key-vault-security"></a>Azure Key Vault セキュリティ

クラウド内の暗号化キーやシークレット (証明書、接続文字列、パスワードなど) を保護するには、Azure Key Vault を使用します。 ビジネスに不可欠な機密データを格納する場合は、コンテナーとそこに格納されるデータのセキュリティを最大化するための手順を実行する必要があります。

## <a name="identity-and-access-management"></a>ID 管理とアクセス管理

Azure サブスクリプション内でキー コンテナーを作成すると、作成したキー コンテナーは、そのサブスクリプションの Azure AD テナントに自動的に関連付けられます。 コンテナーのコンテンツを管理または取得しようとするすべてのユーザーは Azure AD で認証される必要があります。

- 認証では、呼び出し元の ID が確立されます。
- 承認によって、呼び出し元が実行できる操作が決定されます。 Key Vault での承認では、[ロール ベースのアクセス制御](../../role-based-access-control/overview.md) (RBAC) と Azure Key Vault アクセス ポリシーの組み合わせが使用されます。

### <a name="access-model-overview"></a>アクセス モデルの概要

コンテナーに対するアクセスは 2 つのインターフェイスすなわちプレーンを介して行います。 これらのプレーンは、管理プレーンとデータ プレーンです。

- "*管理プレーン*" は Key Vault そのものを管理する場所であり、コンテナーの作成と削除に使用されるインターフェイスです。 キー コンテナーのプロパティを読み取り、アクセス ポリシーを管理することもできます。
- "*データ プレーン*" では、キー コンテナーに格納されているデータを操作できます。 キー、シークレット、証明書の追加、削除、および変更を行うことができます。

いずれのプレーン内でもキー コンテナーにアクセスするには、すべての呼び出し元 (ユーザーまたはアプリケーション) が認証および承認される必要があります。 認証については、両方のプレーンで Azure Active Directory (Azure AD) が使用されます。 承認については、管理プレーンではロールベースのアクセス制御 (RBAC) が使用され、データ プレーンでは Key Vault アクセス ポリシーが使用されます。

1 つのメカニズムで両方のプレーンを認証するモデルには次のようないくつかの利点があります。

- 組織では、組織内のすべてのキー コンテナーへのアクセスを一元的に管理できます。
- 退職したユーザーは、組織内のすべてのキー コンテナーに即座にアクセスできなくなります。
- 組織では、Azure AD のオプションを使用して認証をカスタマイズできます (セキュリティを強化するために多要素認証を有効にするなど)。

### <a name="managing-administrative-access-to-key-vault"></a>キー コンテナーに対する管理アクセスの管理

リソース グループ内にキー コンテナーを作成するとき、Azure AD を使用してアクセスを管理します。 リソース グループ内のキー コンテナーを管理する権限をユーザーまたはグループに付与します。 適切な Azure ロールを割り当てることで、特定のスコープ レベルでアクセスを付与できます。 キー コンテナーを管理するためのアクセス権をユーザーに付与するには、定義済みの `key vault Contributor` ロールを特定のスコープでそのユーザーに割り当てます。 Azure ロールには以下のスコープ レベルを割り当てることができます。

- **サブスクリプション**:サブスクリプション レベルで割り当てられた Azure ロールは、そのサブスクリプション内のすべてのリソース グループとリソースに適用されます。
- **[リソース グループ]** :リソース グループ レベルで割り当てられた Azure ロールは、そのリソース グループ内のすべてのリソースに適用されます。
- **特定のリソース**: 特定のリソースに対して割り当てられた Azure ロールは、そのリソースに適用されます。 この場合、リソースは特定のキー コンテナーです。

定義済みのロールが複数あります。 定義済みのロールがニーズに合わない場合は、独自のロールを定義できます。 詳細については、[RBAC: 組み込みのロール](../../role-based-access-control/built-in-roles.md)に関するページをご覧ください。

> [!IMPORTANT]
> ユーザーがキー コンテナーの管理プレーンに対する `Contributor` 権限を持っている場合は、そのユーザーは Key Vault アクセス ポリシーを設定することで、データ プレーンへのアクセス権を自分自身に付与できます。 ご利用のキー コンテナーへの `Contributor` ロール アクセス権を持つユーザーの管理は厳密に行う必要があります。 承認されたユーザーだけがコンテナー、キー、シークレット、証明書にアクセスできるようにします。

<a id="data-plane-access-control"></a>
### <a name="controlling-access-to-key-vault-data"></a>Key Vault データへのアクセスの制御

Key Vault アクセス ポリシーでは、キー、シークレット、または証明書へのアクセス許可が個別に付与されます。 ユーザーに対してはキーへのアクセス権のみ付与でき、シークレットへのアクセス権は付与できません。 キー、シークレット、証明書へのアクセス許可は、コンテナー レベルで管理されます。

> [!IMPORTANT]
> Key Vault アクセス ポリシーでは、特定のキー、シークレット、証明書など、細かいオブジェクト レベルのアクセス許可はサポートされていません。 キーを作成および削除するためのアクセス許可を付与されたユーザーは、そのキー コンテナー内のすべてのキーに対してそれらの操作を実行できます。

キー コンテナーのアクセス ポリシーは、[Azure portal](assign-access-policy-portal.md)、[Azure CLI](assign-access-policy-cli.md)、[Azure PowerShell](assign-access-policy-powershell.md)、または [Key Vault 管理 REST API](/rest/api/keyvault/) を使用して設定できます。

データ プレーンのアクセスは、[Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)を使用して制限することができます。 追加のセキュリティ層に対して[ファイアウォールと仮想ネットワーク規則](network-security.md)を構成するできます。

## <a name="network-access"></a>ネットワーク アクセス

コンテナーに対するアクセス権を持つ IP アドレスを指定することで、コンテナーの公開を縮小できます。 Azure Key Vault の仮想ネットワーク サービス エンドポイントを使用すると、指定した仮想ネットワークに対するアクセスを制限できます。 エンドポイントでは、IPv4 (インターネット プロトコル バージョン 4) アドレス範囲のリストへのアクセスを制限することもできます。 このようなソースの外部からお使いのキー コンテナーに接続するユーザーはすべて、アクセスを拒否されます。

ファイアウォール ルールを有効にした後は、要求が許可された仮想ネットワークまたは IPv4 アドレス範囲から送信された場合にのみ、ユーザーは Key Vault のデータを読み取ることができます。 これは、Azure portal から Key Vault にアクセスする場合にも適用されます。 ユーザーは Azure portal からキー コンテナーを参照できますが、クライアント マシンが許可リストに登録されていない場合、キー/シークレット/証明書を一覧表示できない場合があります。 これは、他の Azure サービスによる Key Vault 選択機能にも影響します。 ファイアウォール ルールでクライアント マシンが許可されていない場合、ユーザーはキー コンテナーを一覧表示できても、キーは一覧表示できないことがあります。

Azure Key Vault ネットワーク アドレスの詳細については、「[Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)」を参照してください。

## <a name="tls-and-https"></a>TLS と HTTPS

*   Key Vault のフロントエンド (データ プレーン) はマルチテナント サーバーです。 つまり、異なる顧客のキー コンテナーで同じパブリック IP アドレスを共有できます。 分離を実現するため、各 HTTP 要求は、他の要求とは別に認証および承認されます。
*   古いバージョンの TLS で脆弱性が報告される場合がありますが、パブリック IP アドレスが共有されているため、Key Vault サービス チームは、トランスポート レベルで個別のキー コンテナーに対して古いバージョンの TLS を無効にすることはできません。
*   HTTPS プロトコルを使用すると、クライアントは TLS ネゴシエーションに参加できます。 **クライアントで最新バージョンの TLS を強制する**ことができ、クライアントでそれを行うと常に、接続全体で対応するレベルの保護が使用されます。 Key Vault で古い TLS バージョンが引き続きサポートされているからといって、新しい TLS バージョンを使用する接続のセキュリティが損なわれることはありません。
*   TLS プロトコルには既知の脆弱性がありますが、攻撃者が脆弱性のある TLS のバージョンで接続を開始したときに、悪意のあるエージェントがキー コンテナーから情報を抽出できるような、既知の攻撃はありません。 攻撃者はやはり認証と承認を行う必要があり、正当なクライアントが常に最新バージョンの TLS で接続している限り、古いバージョンの TLS の脆弱性によって資格情報が漏洩することはありません。

## <a name="logging-and-monitoring"></a>ログ記録と監視

Key Vault のログによって、コンテナーに対して実行されたアクティビティの情報が保存されます。 詳細については、[Key Vault のログ記録](logging.md)に関する記事を参照してください。

ストレージ アカウントの安全な管理に関する推奨事項については、「[Azure Storage セキュリティ ガイド](../../storage/blobs/security-recommendations.md)」を参照してください。

## <a name="next-steps"></a>次の手順

- [Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)
- [RBAC:組み込みのロール](../../role-based-access-control/built-in-roles.md)に関するページを参照してください。