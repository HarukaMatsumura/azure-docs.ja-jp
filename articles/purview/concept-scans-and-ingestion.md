---
title: スキャンとインジェスト
description: この記事では、Azure Purview でのスキャンとインジェストについて説明します。
author: nayenama
ms.author: nayenama
ms.service: purview
ms.subservice: purview-data-catalog
ms.topic: conceptual
ms.date: 08/18/2021
ms.openlocfilehash: 85509f1500936dfaa0d308b01912ce927f3f380f
ms.sourcegitcommit: d11ff5114d1ff43cc3e763b8f8e189eb0bb411f1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/25/2021
ms.locfileid: "122825228"
---
# <a name="scans-and-ingestion-in-azure-purview"></a>Azure Purview でのスキャンとインジェスト

この記事では、Azure Purview のスキャンとインジェストの機能について説明します。 これらの機能では、Purview アカウントをソースに接続して、データ マップとデータ カタログを設定し、Purview からデータの探索と管理を開始できるようにします。

## <a name="scanning"></a>スキャン

Purview アカウントでデータ ソースを[登録](manage-data-sources.md)したら、次の手順ではデータ ソースをスキャンします。 スキャン プロセスでは、データ ソースへの接続を確立して、名前、ファイル サイズ、列など、技術的なメタデータをキャプチャします。 また、構造化データ ソースのスキーマを抽出して、スキーマの分類を適用します。[Purview アカウントが Microsoft 365 セキュリティ/コンプライアンス センター (SCC) に接続されている場合は、秘密度ラベルを適用します](create-sensitivity-label.md)。 スキャン プロセスをトリガーしてすぐに実行したり、定期的に実行したりして、Purview アカウントを最新の状態に保つことができます。

各スキャンには、必要な情報のソースのみをスキャンするために適用できるカスタマイズがあります。

### <a name="scope-your-scan"></a>スキャンの範囲を指定する

ソースをスキャンする場合は、データ ソース全体をスキャンするか、スキャンする特定のエンティティ (フォルダー/テーブル) のみを選択できます。 使用可能なオプションは、スキャンするソースによって異なり、1 回限りのスキャンと、スケジュールされたスキャンの両方で定義できます。

たとえば、[Azure SQL Database のスキャンを作成して実行する](register-scan-azure-sql-database.md#creating-and-running-a-scan)場合、スキャンするテーブルを選択するか、データベース全体を選択できます。

### <a name="scan-rule-set"></a>スキャン ルール セット

スキャン ルール セットでは、ソースのいずれかに対してスキャンを実行するときに検索する情報の種類を決定します。 使用可能なルールは、スキャンするソースの種類によって異なりますが、スキャンする[ファイルの種類](sources-and-scans.md#file-types-supported-for-scanning)や必要な[分類](supported-classifications.md)の種類などの情報が含まれます。

多くのデータ ソースの種類で既に使用できる[システム スキャン ルールセット](create-a-scan-rule-set.md#system-scan-rule-sets)がありますが、[独自のスキャン ルール セットを作成して](create-a-scan-rule-set.md)、組織に合わせてスキャンを調整することもできます。

### <a name="how-scans-detect-deleted-assets"></a>削除されたアセットをスキャンが検出する方法

Azure Purview カタログは、スキャンを実行するときにのみ、データ ストアの状態を認識します。 ファイル、テーブル、またはコンテナーが削除されたかどうかをカタログで認識するためには、前回のスキャン出力を現在のスキャン出力と比較します。 たとえば、前回 Azure Data Lake Storage Gen2 アカウントをスキャンしたときに、*folder1* という名前のフォルダーが含まれていたとします。 同じアカウントを再度スキャンしたところ、*folder1* は存在しません。 そのため、そのフォルダーが削除されたとカタログによって認識されます。

#### <a name="detecting-deleted-files"></a>削除されたファイルを検出する

不足しているファイルを検出するためのロジックは、同じユーザーおよび異なるユーザーによる複数のスキャンで機能します。 たとえば、あるユーザーがフォルダー A、B、C の Data Lake Storage Gen2 データ ストアに対して 1 回限りのスキャンを実行するとします。その後、同じアカウント内の別のユーザーが、同じデータ ストアのフォルダー C、D、E で 1 回限りのスキャンを別に実行します。 フォルダー C は 2 回スキャンされたため、削除の可能性がカタログによってチェックされます。 ただし、フォルダー A、B、D、E はスキャンされたのは 1 回のみであり、カタログによって削除されたアセットがチェックされることはありません。

削除されたファイルをカタログから除外するようにするためには、スキャンを定期的に実行することが重要です。 削除されたアセットは別のスキャンが実行されるまでカタログで検出されないため、スキャン間隔は重要です。 そのため、特定のストアについて 1 か月に 1 回スキャンを実行する場合、そのストア内の削除されたデータ アセットは、1 か月後に次のスキャンを実行するまでカタログで検出できません。

Data Lake Storage Gen2 のような大規模なデータ ストアを列挙する場合、情報を見逃してしまう要因は複数あります (列挙エラーや破棄されたイベントなど)。 ファイルが作成または削除されたことが特定のスキャンによって見逃されてしまうおそれがあります。 そのため、ファイルは削除されたとカタログで確定されない限り、カタログから削除されません。 この方式では、スキャンされたデータ ストアに存在しないファイルがカタログに存在する場合にエラーが発生するおそれがあることを意味します。 場合によっては、特定の削除されたアセットが把握されるまで、データ ストアを 2 回または 3 回スキャンする必要があります。

## <a name="ingestion"></a>取り込み

スキャン プロセスによって識別される技術的なメタデータまたは分類は、その後インジェストに送信されます。 インジェスト プロセスでは、データ マップを設定し、Purview によって管理されます。  インジェストでは、スキャンからの入力を分析して、[リソース セット パターンを適用し](concept-resource-sets.md#how-azure-purview-detects-resource-sets)、使用可能な[データ系列](concept-data-lineage.md)情報を設定してから、データ マップを自動的に読み込みます。 資産/スキーマは、インジェストの完了後にのみ検出またはキュレーションできます。 そのため、スキャンが完了したが、データ マップまたはカタログに資産が表示されていない場合は、インジェスト プロセスが完了するまで待つ必要があります。

## <a name="next-steps"></a>次の手順

詳細またはソースのスキャンに関する具体的な手順については、次のリンクを参照してください。

* リソース セットについては、[リソース セットに関する記事](concept-resource-sets.md)を参照してください。
* [Azure SQL Database の登録とスキャンの方法](register-scan-azure-sql-database.md#creating-and-running-a-scan)
* [Azure Purview のデータ系列](catalog-lineage-user-guide.md)
